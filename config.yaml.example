# Configuration for the Azure Privileged Access Drift Detector
#
# To use a custom configuration, copy this file to config.yaml and modify it.
# The tool will automatically use config.yaml if it exists in the same directory.
# DO NOT commit config.yaml to version control.

# Define which roles are considered privileged for scanning.
privileged_roles:
  # Azure RBAC roles by their case-sensitive 'roleDefinitionName'.
  azure_rbac:
    - "Owner"
    - "Contributor"
    - "User Access Administrator"
    # Add any other custom or built-in roles you consider privileged.
    # - "Virtual Machine Contributor"

  # Microsoft Entra ID roles by their case-sensitive 'displayName'.
  entra:
    - "Global Administrator"
    - "Privileged Role Administrator"
    - "Security Administrator"
    - "Conditional Access Administrator"
    # - "Exchange Administrator"

# Define which changes are considered high-risk.
risk:
  # New assignments to these RBAC roles will be flagged as 'high' risk.
  high_rbac_roles:
    - "Owner"
    - "User Access Administrator"

  # New assignments to these Entra roles will be flagged as 'high' risk.
  high_entra_roles:
    - "Global Administrator"
    - "Privileged Role Administrator"

  # If true, any new privileged role assignment granted to a guest user
  # will be flagged as 'high' risk, regardless of the role.
  include_guests_as_high: true

  # Defines working hours for context in reports (currently for Teams summary).
  # Not used for any risk calculation logic.
  working_hours:
    start: "08:00"
    end: "18:00"
    tz: "local" # "local" or a valid IANA timezone name like "UTC" or "America/New_York".

# Control the output formats generated by the tool.
output:
  write_csv: true
  write_md: true
  write_json: true
  # If true, principal names (e.g., user display names, UPNs) will be
  # replaced with a SHA256 hash in all report outputs.
  # This is useful for sharing reports publicly without exposing identity information.
  redact_principal_names: false

# Fine-tune how the tool identifies unique role assignments.
matching:
  # If true, uses the immutable roleDefinitionId for RBAC roles when available.
  # This is more precise than using the role name, which can be ambiguous.
  use_role_ids_when_available: true
  # If true, normalizes Azure RBAC scopes by removing leading/trailing slashes
  # and converting to lowercase for more consistent diffing.
  normalize_scopes: true
